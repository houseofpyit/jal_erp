<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <record id="crm_lead_form_view_inherit" model="ir.ui.view">
        <field name="name">crm.lead.form.view.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group/field[@name='priority']" position="replace">
                <field name="priority" required="1"/>
            </xpath>
            <xpath expr="//field[@name='user_id']" position="before">
                <field name="country_id" />
                <field name="is_stage" invisible="1"/>
            </xpath>
            <xpath expr="//group[@name='lead_priority']/field[@name='priority']" position="replace">
                <field name="priority" required="1"/>
            </xpath>
            <xpath expr="//field[@name='team_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='team_id']" position="after">
                <field name="business_type" invisible="1"/>
                <field name="continent_type" invisible="0"/>

                <field name="partner_name"/>
                <label for="street_page_lead" string="Address"/>
                <div class="o_address_format">
                    <field name="street" id="street_page_lead" placeholder="Street..." class="o_address_street"/>
                    <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                    <field name="city" placeholder="City" class="o_address_city"/>
                    <field name="state_id" class="o_address_state" placeholder="State" options="{&quot;no_open&quot;: True}"/>
                    <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                    <field name="country_id" placeholder="Country" class="o_address_country" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                </div>
                <!-- <field name="website" widget="url" placeholder="e.g. https://www.odoo.com"/>
                <field name="lang_id" options="{'no_create': True}"/> -->
            </xpath>
            <xpath expr="//h2[hasclass('o_row') and hasclass('no-gutters') and hasclass('align-items-end')]/div[hasclass('col')][1]" position="before">
                <div class="col" attrs="{'invisible': [('type', '=', 'lead')]}">
                    <label for="quantity" class="oe_edit_only"/>
                    <div class="o_row">
                        <field name="quantity" class="oe_inline"/>
                    </div>
                </div>
                <div class="col">
                    <label for="unit_id" class="oe_edit_only"/>
                    <div class="o_row">
                        <field name="unit_id" class="oe_inline" options="{'no_open': True, 'no_create': True}"/>
                    </div>
                </div>
                <div class="col">
                    <label for="unit_price" class="oe_edit_only"/>
                    <div class="o_row">
                        <field name="unit_price" class="oe_inline"  widget="monetary"/>
                    </div>
                </div>
            </xpath>
            <xpath expr="//field[@name='company_id']" position="after">
                <field name="company_currency" readonly="0" force_save="1" options="{'no_open': True, 'no_create': True}"/>
                <label for="contact_name_page_lead"/>
                <div class="o_row">
                    <field name="contact_name" id="contact_name_page_lead"/>
                    <field name="title" placeholder="Title" domain="[]" options="{&quot;no_open&quot;: True}"/>
                </div>
                <!-- <field name="function"/> -->
                <label for="mobile_page_lead" class="oe_inline"/>
                <div class="o_row o_row_readonly">
                    <button name="phone_action_blacklist_remove" class="fa fa-ban text-danger" title="This phone number is blacklisted for SMS Marketing. Click to unblacklist." type="object" context="{'default_phone': mobile}" groups="base.group_user" attrs="{'invisible': [('mobile_blacklisted', '=', False)]}"/>
                    <field name="mobile" id="mobile_page_lead" widget="phone"/>
                </div>
                <field name="company_id" required="1" options="{'no_create': True}"/>
            </xpath>
            <xpath expr="//page[@name='lead']//group/field[@name='partner_name']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='lead']//group/div[1]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='lead']//group/label[1]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='lead']/group/group[3]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='lead']//group/label[@for='contact_name_page_lead']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='lead']/group/group[2]/div[1]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='lead']//group/label[@for='mobile_page_lead']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='lead']/group/group[2]/div[2]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='lead']/group/group[4]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>

    <record id="crm_lead_kanban_view_inherit" model="ir.ui.view">
        <field name="name">crm.lead.kanban.view.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>
        <field name="arch" type="xml">
            <xpath expr="//kanban" position="replace">
                <kanban class="o_kanban_small_column o_opportunity_kanban"
                    default_group_by="stage_id"
                    default_order="priority asc"
                    archivable="false"
                    sample="1">
                    <field name="stage_id" options='{"group_by_tooltip": {"requirements": "Description"}}'/>
                    <field name="probability"/>
                    <field name="color"/>
                    <field name="priority"/>
                    <field name="expected_revenue"/>
                    <field name="kanban_state"/>
                    <field name="activity_date_deadline"/>
                    <field name="user_email"/>
                    <field name="user_id"/>
                    <field name="partner_id"/>
                    <field name="activity_summary"/>
                    <field name="active"/>
                    <field name="company_currency"/>
                    <field name="activity_state" />
                    <field name="activity_ids" />
                    <field name="is_stage" invisible="1"/>
                    <progressbar field="activity_state" colors='{"planned": "success", "today": "warning", "overdue": "danger"}' sum_field="expected_revenue" help="This bar allows to filter the opportunities based on scheduled activities."/>
                    <templates>
                        <t t-name="kanban-box">
                            <t t-set="lost_ribbon" t-value="!record.active.raw_value and record.probability and record.probability.raw_value == 0"/>
                            <div t-attf-class="#{!selection_mode ? kanban_color(record.color.raw_value) : ''} #{lost_ribbon ? 'oe_kanban_card_ribbon' : ''} oe_kanban_global_click oe_kanban_card d-flex flex-column">
                                <div class="ribbon ribbon-top-right"
                                    attrs="{'invisible': ['|', ('probability', '&gt;', 0), ('active', '=', True)]}">
                                    <span class="bg-danger">Lost</span>
                                </div>

                                <div class="o_dropdown_kanban dropdown">
                                    <a class="dropdown-toggle o-no-caret btn" role="button" data-toggle="dropdown" data-display="static" href="#" aria-label="Dropdown menu" title="Dropdown menu">
                                        <span class="fa fa-ellipsis-v"/>
                                    </a>
                                    <div class="dropdown-menu" role="menu">
                                        <t t-if="widget.editable"><a role="menuitem" type="edit" class="dropdown-item">Edit</a></t>
                                        <t t-if="widget.deletable"><a role="menuitem" type="delete" class="dropdown-item">Delete</a></t>
                                        <ul class="oe_kanban_colorpicker" data-field="color"/>
                                    </div>
                                </div>
                                <div class="oe_kanban_content flex-grow-1">
                                    <t t-if="record.priority.raw_value == '0'">
                                        <div style="background-color: red; text-align: center; font-weight: bold; color: white; border-radius: 4px; padding: 2px;">
                                            Hot
                                        </div>
                                    </t>
                                    <t t-if="record.priority.raw_value == '1'">
                                        <div style="background-color: yellow; text-align: center; font-weight: bold; border-radius: 4px; padding: 2px;">
                                            Mild
                                        </div>
                                    </t>
                                    <t t-if="record.priority.raw_value == '2'">
                                        <div style="background-color: blue; text-align: center; font-weight: bold; color: white; border-radius: 4px; padding: 2px;">
                                            Cold
                                        </div>
                                    </t>
                                    <div class="oe_kanban_content flex-grow-1">
                                        <!-- Partner & Lead Name -->
                                        <div class="o_kanban_record_title oe_kanban_details">
                                            <strong><field name="partner_id"/></strong>
                                        </div>
                                        <!-- Quantity & Country -->
                                        <div class="o_kanban_record_subtitle">
                                            <strong>Qty:</strong> <field name="quantity"/>
                                        </div>
                                        <div class="o_kanban_record_subtitle">
                                            <strong>Country:</strong> <field name="country_id"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="oe_clear"/>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </xpath>
        </field>
    </record>

    <record id="crm_lead_create_form_view_inherit" model="ir.ui.view">
        <field name="name">crm.lead.create.form.view.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.quick_create_opportunity_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div/field[@name='priority']" position="replace">
                <field name="priority" class="oe_inline" nolabel="1" />
            </xpath>
        </field>
    </record>

    <record id="crm_lead_tree_view_inherit" model="ir.ui.view">
        <field name="name">crm.lead.tree.view.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_oppor"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='priority']" position="replace">
                <field name="priority" optional="hide" />
            </xpath>
        </field>
    </record>

    <record id="inherit_view_crm_case_opportunities_filter" model="ir.ui.view">
        <field name="name">inherit.crm.lead.search.opportunities</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_opportunities_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='saleschannel']" position="after">
                <filter string="Priority" name="priority" context="{'group_by':'priority'}"/>
                <filter string="Continent" name="continent_type" context="{'group_by':'continent_type'}"/>
            </xpath>
        </field>
    </record>

    <record id="crm_stage_form_view_inherit" model="ir.ui.view">
        <field name="name">crm.stage.form.view.inherit</field>
        <field name="model">crm.stage</field>
        <field name="inherit_id" ref="crm.crm_stage_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='is_won']" position="after">
                <field name="is_performa" />
                <field name="is_quotation" />
                <field name="is_lost" />
            </xpath>
        </field>
    </record>


    <record model="ir.actions.act_window" id="crm_lead_action_pipeline_international">
        <field name="name">Pipeline</field>
        <field name="res_model">crm.lead</field>
        <field name="view_mode">kanban,tree,graph,pivot,form,calendar,activity</field>
        <field name="domain">[('type','=','opportunity'),('business_type', '=', 'international')]</field>
        <field name="context">{
                'default_type': 'opportunity',
                'search_default_assigned_to_me': 1,
                'default_business_type':'international'
        }</field>
        <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
    </record>

    <record model="ir.actions.act_window" id="crm_lead_action_pipeline_domestic">
        <field name="name">Pipeline</field>
        <field name="res_model">crm.lead</field>
        <field name="view_mode">kanban,tree,graph,pivot,form,calendar,activity</field>
        <field name="domain">[('type','=','opportunity'),('business_type', '=', 'domestic')]</field>
        <field name="context">{
                'default_type': 'opportunity',
                'search_default_assigned_to_me': 1,
                'default_business_type':'domestic'
        }</field>
        <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
    </record>

    <record model="ir.actions.act_window" id="crm_lead_action_pipeline_trading">
        <field name="name">Pipeline</field>
        <field name="res_model">crm.lead</field>
        <field name="view_mode">kanban,tree,graph,pivot,form,calendar,activity</field>
        <field name="domain">[('type','=','opportunity'),('business_type', '=', 'trading')]</field>
        <field name="context">{
                'default_type': 'opportunity',
                'search_default_assigned_to_me': 1,
                'default_business_type':'trading'
        }</field>
        <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
    </record>

</odoo>

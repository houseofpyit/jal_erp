<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="report_sale_proforma">
            <t t-call="web.basic_layout">
                <style>
                    td{
                        font-size:13px;
                        padding-left:8px;
                        padding-right:3px;
                    }
                    <!-- span{
                        padding:5px;
                    } -->
                    td, th, table {
                        border-collapse: collapse !important;
                    }
                </style>
                <t t-foreach="docs" t-as="o">
                    <div class="header">
                        <table>
                            <tr>
                                <td>
                                    <t t-if="o.company_id.header_image">
                                        <img class="img img-responsive" t-att-src="image_data_uri(o.company_id.header_image)" alt="Logo" style="width:900px; height:100px;"/>
                                    </t>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="page">
                        <table style="width:100%;" v-align="top">
                            <tr>
                                <td width="50%" style="padding-left:10px;">
                                    <b><span style="font-size:20px;padding-right:5px;color:#5796c6;">PROFORMA INVOICE <span style="font-size:20px;color:#5796c6;" t-esc="o.name" /></span></b><br/>
                                </td>
                                <td width="50%" style="padding-left:10px;text-align:right;">
                                    <b><span>PO : </span></b>
                                    <span t-esc="o.po_no"/>
                                    <b>
                                        <span style="padding-left:5px; display:inline-block; width:80px; text-align:right;">
                                            PO Date:
                                        </span>
                                    </b>
                                    <t t-if="o.po_date">
                                        <span t-esc="o.po_date.strftime('%d/%m/%Y')"/>
                                    </t>
                                    <br/>
                                    <b><span>QUOTE : </span></b>
                                    <span t-esc="o.name"/>
                                    <b>
                                        <span style="padding-left:5px; display:inline-block; width:80px; text-align:right;">
                                            VALIDITY:
                                        </span>
                                    </b>
                                    <span t-esc="o.payment_term_id.name"/>
                                </td>
                            </tr>
                        </table>
                        <table style="width:100%;" >
                            <tr>
                                <td style="padding-bottom:5px;padding-top:5px;width:50%;">
                                    <b><span style="padding-bottom:5px;">BENEFICIARY'S BANK DETAILS</span></b>
                                </td>
                                <td style="padding-bottom:5px;padding-top:5px;width:50%;">
                                    <b><span style="padding-bottom:5px;">ADDITIONAL BANK DETAILS </span></b>
                                </td>
                            </tr>
                        </table>
                        <table style="width:100%;" >
                            <tr>
                                <td width="15%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span>Bank :</span>
                                    <span>A/C No. :</span><br/>
                                    <span>RTGS/MICR Code : </span><br/>
                                    <span>Branch :</span><br/>
                                    <span>SWIFT Code : </span><br/>
                                    <span>Currency : </span>
                                </td>
                                <td width="35%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span style="padding-top:0px;" t-esc="o.bank_id.name" /><br/>
                                    <span style="padding-top:0px;" t-esc="o.bank_id.bank_ac_name" /><br/>
                                    <span style="padding-top:0px;" t-esc="o.bank_id.bank_ac_no" /><br/>
                                    <span style="padding-top:0px;" t-esc="o.bank_id.bank_branch_ifsc"/><br/>
                                    <span style="padding-top:0px;" t-esc="o.bank_id.currency_id.name"/>
                                </td>
                                <td width="20%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span>Correspondent Bank :</span><br/>
                                    <span>Currency :</span><br/>
                                    <span>Swift Code: </span><br/>
                                    <span>Account Number : </span>
                                </td>
                                <td width="30%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span t-esc="o.bank_id.correspondent_bank" /><br/>
                                    <span t-esc="o.bank_id.currency1_id.name" /><br/>
                                    <span t-esc="o.bank_id.swift_code1"/>
                                    <span t-esc="o.bank_id.acc_no" /><br/>
                                </td>
                            </tr>
                        </table>
                        <table style="width:100%;" >
                            <tr>
                                <td style="padding-bottom:5px;padding-top:5px;width:50%;">
                                    <b><span style="padding-bottom:5px;">CONSIGNEE</span></b>
                                </td>
                                <td style="padding-bottom:5px;padding-top:5px;width:50%;">
                                    <t t-if="o.buyer_notify_id">
                                        <b><span style="padding-bottom:5px;">BUYER &amp; NOTIFY (1) </span></b>
                                    </t>
                                </td>
                            </tr>
                        </table>
                        <table style="width:100%;" >
                            <tr>
                                <td width="9%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span>Company :</span><br/>
                                    <span>Address :</span><br/><br/>
                                    <span>Country :</span><br/>
                                    <span>Phone :</span><br/>
                                    <span>Email :</span>
                                    <!-- <span>GST No.</span> -->
                                </td>
                                <td width="41%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span t-esc="o.partner_id.name" /><br/>
                                    <span t-esc="o.partner_id.street" style="padding-right:3px;"/>
                                    <span t-esc="o.partner_id.street2" style="padding-right:3px;"/>
                                    <span t-esc="o.partner_id.city" /><t t-if="o.partner_id.state_id">
                                        ,<span t-esc="o.partner_id.state_id.name" />
                                    </t><t t-if="o.partner_id.zip">
                                        ,<span t-esc="o.partner_id.zip" />
                                    </t><br/>
                                    <span  t-esc="o.partner_id.country_id.name" /><br/>
                                    <span  t-esc="o.partner_id.phone" style="padding-right:3px;"/><span t-esc="o.partner_id.mobile" /><br/>
                                    <span t-esc="o.partner_id.email" />
                                    <!-- <span t-esc="o.partner_id.vat" /> -->
                                </td>
                                <td width="9%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <t t-if="o.buyer_notify_id">
                                        <span>Company :</span><br/>
                                        <span>Address :</span><br/><br/>
                                        <span>Country :</span><br/>
                                        <span>Phone :</span><br/>
                                        <span>Email :</span>
                                    </t>
                                </td>
                                 <td width="41%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <t t-if="o.buyer_notify_id">
                                        <span t-esc="o.buyer_notify_id.name" /><br/>
                                        <span t-esc="o.buyer_notify_id.street" style="padding-right:3px;"/>
                                        <span t-esc="o.buyer_notify_id.street2" style="padding-right:3px;"/>
                                        <span t-esc="o.buyer_notify_id.city" /><t t-if="o.partner_id.state_id">
                                            ,<span t-esc="o.buyer_notify_id.state_id.name" />
                                        </t><t t-if="o.buyer_notify_id.zip">
                                            ,<span t-esc="o.buyer_notify_id.zip" />
                                        </t><br/>
                                        <span  t-esc="o.buyer_notify_id.country_id.name" /><br/>
                                        <span  t-esc="o.buyer_notify_id.phone" style="padding-right:3px;"/><span t-esc="o.partner_id.mobile" /><br/>
                                        <span t-esc="o.buyer_notify_id.email" /><br/>
                                    </t>
                                </td>
                            </tr>
                        </table>
                        <table style="width:100%;" >
                            <tr>
                                <td style="padding-bottom:5px;padding-top:5px;width:50%;">
                                    <b><span style="padding-bottom:5px;">DELIVERY AND PAYMENT TERMS</span></b>
                                </td>
                                <td style="padding-bottom:5px;padding-top:5px;width:50%;">
                                    <b><span style="padding-bottom:5px;">TRANSPORT DETAILS</span></b>
                                </td>
                            </tr>
                        </table>
                        <table style="width:100%;" >
                            <tr>
                                <td width="15%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span>INCOTERMS :</span><br/>
                                    <span>DELIVERY TERMS :</span><br/><br/>
                                    <span>PAYMENT TERMS :</span>
                                </td>
                                <td width="35%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span t-esc="o.incoterm_id.name" /><br/>
                                    <span t-esc="o.terms_id.name" /><br/><br/>
                                    <span t-esc="o.payment_term_id.name"/>
                                </td>
                                <td width="28%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span>PORT OF LOADING : </span><br/>
                                    <span>PORT OF DISCHARGE : </span><br/>
                                    <span>COUNTRY OF FINAL DESTINATION :</span><br/>
                                    <span>COUNTRY OF ORIGIN OF GOODS :</span>
                                </td>
                                <td width="23%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                    <span t-esc="o.partner_id.country_id.name" /><br/>
                                    <span t-esc="o.port_id.name" /><br/>
                                    <span t-esc="o.port_id.country_id.name" /><br/>
                                    <span t-esc="o.country_id.name" />
                                </td>
                            </tr>
                        </table>
                        <table style="width:100%;" >
                            <t t-if="o.buyer_ref_details">
                            <tr>
                                <td colspan="2" style="padding-bottom:5px;padding-top:5px;">
                                        <b><span style="padding-bottom:5px;">BUYER REFERENCE DETAILS</span></b>
                                    </td>
                                    <td colspan="2" style="padding-bottom:5px;padding-top:5px;"></td>
                                </tr>
                            </t>
                            <t t-if="o.buyer_ref_details">
                            <tr>
                                <td width="25%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                        <span><span t-esc="o.buyer_ref_details"></span></span>  
                                        
                                    </td>
                                    <td width="25%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;">
                                        
                                    </td>
                                    <td width="25%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;"></td>
                                    <td width="25%" style="padding-top:5px;padding-bottom:5px;border-bottom: 1px solid black;"></td>
                                </tr>
                            </t>
                        </table>

                        <table width="100%" style="border: 1px solid black;border-top:none;">
                            <tr>
                                <th style="border-bottom: 1px solid black;border-right: 1px solid black;font-size:13px;text-align:center;background-color:#005fa9;color:white;">SRL</th>
                                 <t t-if="o.display_name_on_pi == 'product_name'">
                                        <th style="border-bottom: 1px solid black;border-right: 1px solid black;font-size:13px;text-align:center;background-color:#005fa9;color:white;">PRODUCT</th>
                                    </t>
                                    <t t-else="o.display_name_on_pi == 'shipping_name'">
                                        <th style="border-bottom: 1px solid black;border-right: 1px solid black;font-size:13px;text-align:center;background-color:#005fa9;color:white;">SHIPPING</th>
                                    </t>
                                <th style="border-bottom: 1px solid black;border-right: 1px solid black;font-size:13px;text-align:center;background-color:#005fa9;color:white;">PACKING DESCRIPTION</th>
                                <th style="border-bottom: 1px solid black;border-right: 1px solid black;font-size:13px;text-align:center;background-color:#005fa9;color:white;">PACKING</th>
                                <th style="border-bottom: 1px solid black;border-right: 1px solid black;font-size:13px;text-align:center;background-color:#005fa9;color:white;">QTY UNIT</th>
                                <th style="border-bottom: 1px solid black;border-right: 1px solid black;font-size:13px;text-align:center;background-color:#005fa9;color:white;">UNIT PRICE</th>
                                <th style="border-bottom: 1px solid black;border-right: 1px solid black;font-size:13px;text-align:center;background-color:#005fa9;color:white;">TOTAL PRICE</th>
                            </tr>
                            <t t-set="srl" t-value="0" />
                            <t t-set="tot_pcs" t-value="0" />
                            <t t-set="tot_amt" t-value="0" />
                            <t t-set="tot_final_amt" t-value="0" />
                            
                            <t t-foreach="o.order_line" t-as="item">
                                <t t-if="item.product_tmpl_id">
                                    <t t-set="srl" t-value="srl + 1" />
                                    <t t-set="tot_pcs" t-value="tot_pcs + item.product_uom_qty" />
                                    <t t-set="tot_amt" t-value="tot_amt + item.price_unit" />
                                    <t t-set="tot_final_amt" t-value="tot_final_amt + item.price_subtotal" />

                                    <!-- <t t-if="item.bucket_cap_id.weight">
                                        <t t-set="tot_weight" t-value="(item.product_uom_qty * item.product_uom.ratio) / item.bucket_cap_id.weight" />
                                    </t>
                                    <t t-else="">
                                        <t t-set="tot_weight" t-value="0.0" />
                                    </t> -->
                                    <tr>
                                        <td style="text-align: center;border-right: 1px solid black;border-bottom: 1px solid black;">
                                            <span><span t-esc="srl"></span></span>
                                        </td>
                                        <td style="text-align: left;border-right: 1px solid black;border-bottom: 1px solid black;">
                                            <!-- <span><span t-esc="item.product_tmpl_id.name"></span></span><br/> -->
                                            <t t-if="o.display_name_on_pi == 'product_name'">
                                                 <span><span t-esc="o.product_shipping_id.name"></span></span><br/>
                                             </t>
                                             <t t-else="o.display_name_on_pi == 'shipping_name'">
                                                 <span><span t-esc="o.shipping_id.name"></span></span><br/>
                                             </t>
                                            <t t-if="item.product_tmpl_id.hsn_id">
                                                <span>Hsn - <span t-esc="item.product_tmpl_id.hsn_id.name"></span></span><br/>
                                            </t>
                                            <t t-if="item.grade_id">
                                                <span>Grade - <span t-esc="item.grade_id.name"></span></span><br/>
                                            </t>
                                            <t t-if="item.mesh_id">
                                                <span>Mesh - <span t-esc="item.mesh_id.name"></span></span>
                                            </t>
                                        </td>
                                        <td style="text-align: left; border-right: 1px solid black;border-bottom: 1px solid black; padding: 0;padding-left:3px;">
                                            <span t-esc="item.packing_name"></span>
                                            <t t-if="item.name">
                                                <span style="font-weight: bold;"> Loading Description: </span><br/>
                                                <span t-esc="item.name"/>
                                            </t>
                                        </td>

                                        <td style="text-align: right;border-right: 1px solid black;border-bottom: 1px solid black;">
                                            <span t-esc="'%.0f' % item.bucket"/> <b><t t-if="item.packing_type">
                                                <span t-esc="dict(item.fields_get(allfields=['packing_type'])['packing_type']['selection'])[item.packing_type]"/>
                                            </t></b>
                                        </td>
                                        <td style="text-align: center;border-right: 1px solid black;border-bottom: 1px solid black;">
                                            <span style="padding-right:2px;" t-esc="item.product_uom_qty"/> <span t-esc="item.product_uom.name"/>
                                        </td>
                                        <td style="text-align: right;border-right: 1px solid black;border-bottom: 1px solid black;">
                                            <span ><span t-esc="'{:,.2f}'.format(float(item.price_unit))"></span></span> <span t-esc="o.currency_id.name"/>
                                        </td>
                                        <td style="text-align: right;border-bottom: 1px solid black;">
                                            <span ><span t-esc="'{:,.2f}'.format(float(item.price_subtotal))"></span></span> <span t-esc="o.currency_id.name"/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-elif="item.name">
                                    <t t-set="srl" t-value="0" />
                                    <tr>
                                        <td colspan="7" style="border: 1px solid black;padding-bottom:2px;padding-top:4px;">
                                            <b><span t-esc="item.name"/></b>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                            <tr style="border:1px solid black;border-left:none;border-right:none;">
                                <td style="border:1px solid black;border-left:none;border-right:none;border-right: 1px solid black;"></td>
                                <td style="border:1px solid black;border-left:none;border-right:none;border-right: 1px solid black;"></td>
                                <td style="border:1px solid black;border-left:none;border-right:none;border-right: 1px solid black;"></td>
                                <td style="border:1px solid black;border-left:none;border-right:none;text-align:right;border-right: 1px solid black;">
                                </td>
                                <td style="border:1px solid black;border-left:none;border-right:none;text-align:right;border-right: 1px solid black;">
                                </td>
                                <!-- <td style="border:1px solid black;border-left:none;border-right:none;text-align:right;border-right: 1px solid black;">
                                    <t t-esc="tot_pcs" />
                                </td> -->
                                <td style="border:1px solid black;border-left:none;border-right:none;text-align:right;border-right: 1px solid black;">
                                    <t t-esc="'{:,.2f}'.format(float(tot_amt))" /> <span t-esc="o.currency_id.name"/>
                                </td>
                                <td style="border:1px solid black;border-left:none;border-right:none;text-align:right;">
                                    <t t-esc="'{:,.2f}'.format(float(tot_final_amt))" /> <span t-esc="o.currency_id.name"/>
                                </td>
                            </tr>
                        </table>
                        <div style="height:5px;"></div>
                        <table style="width:100%; border-collapse:collapse;">
                            <tr>
                                <td style="width:65%; vertical-align:top;">
                                    <span style="padding-right:3px;"><b>PALLETIZED CARGO :</b></span>
                                    <span t-esc="o.palletized_type"/> <br/>

                                    <span style="padding-right:3px;"><b>PRE-SHIPMENT INSPECTION :</b></span>
                                    <span t-esc="o.inspection"/> <br/>

                                    <t t-if="o.freight > 0">
                                        <span style="padding-right:3px;"><b>TOTAL FREIGHT :</b></span>
                                        <span t-esc="o.freight"/> <br/>

                                        <span style="padding-right:3px;"><b>TOTAL INSURANCE :</b></span>
                                        <span t-esc="o.insurance"/> <br/>

                                        <span style="padding-right:3px;"><b>TOTAL FOB :</b></span>
                                        <span t-esc="o.fob_rates"/>
                                    </t>
                                </td>

                                <td style="width:35%; vertical-align:top;">
                                    <table style="width:100%; border-collapse:collapse; border:1px solid black;">
                                        <tr>
                                            <td style="padding:4px; border:1px solid black;font-size:13px;">
                                                <span>Untaxed Amount</span>
                                            </td>
                                            <td style="padding:4px; border:1px solid black; text-align:right; font-size:13px; padding-right:7px;">
                                                <t t-if="o.currency_id.position == 'before'">
                                                    <span t-esc="o.currency_id.symbol"/> 
                                                    <span t-esc="'{:,.2f}'.format(float(o.tot_amt))"/>
                                                </t>
                                                <t t-if="o.currency_id.position == 'after'">
                                                    <span t-esc="'{:,.2f}'.format(float(o.tot_amt))"/> 
                                                    <span t-esc="o.currency_id.symbol"/>
                                                </t>
                                            </td>
                                        </tr>
                                        <t t-if="o.tot_cgst">
                                            <tr>
                                                <td style="padding:4px; border:1px solid black; background-color:#f3f4f6; font-size:13px;">
                                                    CGST Amt
                                                </td>
                                                <td style="padding:4px; border:1px solid black; text-align:right; background-color:#f3f4f6; font-size:13px; padding-right:7px;">
                                                    <t t-if="o.currency_id.position == 'before'">
                                                        <span t-esc="o.currency_id.symbol"/> <span t-esc="'{:,.2f}'.format(float(o.tot_cgst))"/>
                                                    </t>
                                                    <t t-if="o.currency_id.position == 'after'">
                                                        <span t-esc="'{:,.2f}'.format(float(o.tot_cgst))"/> <span t-esc="o.currency_id.symbol"/>
                                                    </t>
                                                </td>
                                            </tr>
                                        </t>
                                        <t t-if="o.tot_sgst">
                                            <tr>
                                                <td style="padding:4px; border:1px solid black; background-color:#f3f4f6; font-size:13px;">
                                                    SGST Amt
                                                </td>
                                                <td style="padding:4px; border:1px solid black; text-align:right; background-color:#f3f4f6; font-size:13px; padding-right:7px;">
                                                    <t t-if="o.currency_id.position == 'before'">
                                                        <span t-esc="o.currency_id.symbol"/> <span t-esc="'{:,.2f}'.format(float(o.tot_sgst))"/>
                                                    </t>
                                                    <t t-if="o.currency_id.position == 'after'">
                                                        <span t-esc="'{:,.2f}'.format(float(o.tot_sgst))"/> <span t-esc="o.currency_id.symbol"/>
                                                    </t>
                                                </td>
                                            </tr>
                                        </t>
                                        <t t-if="o.tot_igst">
                                            <tr>
                                                <td style="padding:4px; border:1px solid black; background-color:#f3f4f6; font-size:13px;">
                                                    IGST Amt
                                                </td>
                                                <td style="padding:4px; border:1px solid black; text-align:right; background-color:#f3f4f6; font-size:13px; padding-right:7px;">
                                                    <t t-if="o.currency_id.position == 'before'">
                                                        <span t-esc="o.currency_id.symbol"/> <span t-esc="'{:,.2f}'.format(float(o.tot_igst))"/>
                                                    </t>
                                                    <t t-if="o.currency_id.position == 'after'">
                                                        <span t-esc="'{:,.2f}'.format(float(o.tot_igst))"/> <span t-esc="o.currency_id.symbol"/>
                                                    </t>
                                                </td>
                                            </tr>
                                        </t>
                                        <tr>
                                            <td style="padding:4px; border:1px solid black; background-color:#005fa9; font-size:13px;">
                                                <span style="color:white;">Total</span>
                                            </td>
                                            <td style="padding:4px; border:1px solid black; text-align:right; background-color:#005fa9; padding-right:7px; font-size:13px;">
                                                <t t-if="o.currency_id.position == 'before'">
                                                    <span style="color:white;" t-esc="o.currency_id.symbol"/> 
                                                    <span style="color:white;" t-esc="'{:,.2f}'.format(float(o.net_amt))"/>
                                                </t>
                                                <t t-if="o.currency_id.position == 'after'">
                                                    <span style="color:white;" t-esc="'{:,.2f}'.format(float(o.net_amt))"/> 
                                                    <span style="color:white;" t-esc="o.currency_id.symbol"/>
                                                </t>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                        <div style="height:5px;"></div>
                        <table style="width:100%;" >
                            <tr>
                                <td>    
                                    <b><span>TERMS &amp; CONDITIONS</span></b><br/>
                                    <span t-esc="o.note" />
                                </td>
                                <td style="text-align:right;">    
                                    <b><span>APPROVED BY</span></b><br/>
                                    <t t-if="o.company_id.logo">
                                        <img class="img img-responsive" t-att-src="image_data_uri(o.company_id.logo)" alt="Logo" style="width:130px; height:100px;" />
                                    </t>
                                </td>
                            </tr>
                        </table>
                    </div>
                </t>
            </t>
        </template>
    </data>
</odoo>